Fully supervised model, with the classes term and the constraint term. 
